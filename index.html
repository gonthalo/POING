<!doctype html>
<html>
<head>
	<title>POING 2</title>
</head>
<body>
	<h2 align="center" style="align: center">En este lugar se encuentra la suprema Verdad:</h2>
	<div style="margin-left: 70px">
		<canvas id="lienzo" height="500px" width="1200px" style="border:2px solid #00d070;">
			Your browser does not support the HTML5 canvas tag.
		</canvas>
	</div>
	<script type="text/javascript" lenguage="javascript">
var lienzo = document.getElementById("lienzo");
var pluma = lienzo.getContext("2d");
var pars = [];
var mapa = [];
var g = 0;
var magnet=0;
var wallx=true;
var wally=true;
var ymax=500;
var xmax=1200;
var bacolor = "beige";
function Jugador() {
	this.m = 5;
	this.q = Math.floor(Math.random()*3) - 1;
	this.x = Math.random()*1160 + 20;
	this.y = Math.random()*460 + 20;
	this.vx = Math.random()*6 - 3;
	this.vy = Math.random()*6 - 3;
}

Jugador.prototype.mover = function() {
	this.x = this.x + this.vx;
	this.y = this.y + this.vy;
	if (this.x>1180 || this.x<20){
		if (wallx){
			this.vx = 0-this.vx;
		} else {
			this.x = (this.x + 1200)%1200;
		}
	}
	if (this.y>480 || this.y<20){
		if (wally){
			this.vy = 0-this.vy;
		} else {
			this.y = (this.y + 500)%500;
		}
	}
	if (this.y<480){
		this.vy = this.vy + g;
	}
	this.vy = this.vy + 0.3*this.q*magnet*this.vx/this.m;
	this.vx = this.vx - 0.3*this.q*magnet*this.vy/this.m;
};

Jugador.prototype.entrada = function jugador_entrada(keyCode) {
	if(keyCode == 87 && this.vy > -15) {
		this.vy = this.vy - 1;
	}
	if(keyCode == 65 && this.vx > -15) {
		this.vx = this.vx - 1;
	}
	if(keyCode == 68 && this.vx < 15) {
		this.vx = this.vx + 1;
	}
	if(keyCode == 83 && this.vy < 15) {
		this.vy = this.vy + 1;
	}
	if(keyCode == 69){
		this.vy = 0;
		this.vx = 0;
	}
	if(keyCode == 67){
		this.y = 250;
		this.x = 600;
	}
};

Jugador.prototype.dibujar = function () {
	pluma.fillStyle = bacolor;
	pluma.fillRect(0, 0, 1200, 500);
	pluma.fillStyle = "black";
	pluma.font = "20px Times"
	pluma.fillText("m = ", 20, 30);
	pluma.fillText(this.m, 60, 30);
	pluma.fillText("Q = ", 20, 50);
	pluma.fillText(this.q, 60, 50);
	var i;
	pluma.beginPath();
	for (i=1; i<10; i=i + 1.4){
		pluma.arc(this.x,this.y,i,0,2*Math.PI);
	}
	pluma.stroke();
};

function Par() {
	this.m = Math.random()*4 + 1;
	this.q = Math.floor(Math.random()*3) - 1;
	this.x = Math.random()*1160 + 20;
	this.y = Math.random()*460 + 20;
	this.vx = Math.random()*6 - 3;
	this.vy = Math.random()*6 - 3;
}

Par.prototype.mover = function() {
	this.x = this.x + this.vx;
	this.y = this.y + this.vy;
	if (this.x>1180 || this.x<20){
		if (wallx){
			this.vx = 0-this.vx;
		} else {
			this.x = (this.x + 1200)%1200;
		}
	}
	if (this.y>480 || this.y<20){
		if (wally){
			this.vy = 0-this.vy;
		} else {
			this.y = (this.y + 500)%500;
		}
	}
	if (this.y<480){
		this.vy = this.vy + g;
	}
	this.vy = this.vy + 0.1*this.q*magnet*this.vx;
	this.vx = this.vx - 0.1*this.q*magnet*this.vy;
};

Par.prototype.dibujar = function () {
	if (this.q==0){
		pluma.fillStyle = "black";
	} else {
		if (this.q==1){
			//pluma.fillText("+", Math.floor(this.x), Math.floor(this.y));
			pluma.fillStyle = "red";
		} else {
			//pluma.fillText("-", Math.floor(this.x); Math.floor(this.y));
			pluma.fillStyle = "blue";
		}
	}
	pluma.beginPath();
	pluma.arc(this.x,this.y,10,0,2*Math.PI);
	pluma.stroke();
};

function comenzar() {
	var n;
	for (n=0; n<240; ++n){
		mapa [n] = Math.floor(Math.random()*8);
	}
	for (n=0; n<3; ++n){
		pars[n] = new Par();
	}
	jugador = new Jugador();
}

function jugar() {
	jugador.dibujar();
	pars.forEach(function (par) {
		par.dibujar();
	});
	jugador.mover();
	pars.forEach(function (par) {
		par.mover();
	});
}

window.addEventListener("keydown", function(event) {
	jugador.entrada(event.keyCode);
	if (event.keyCode == 71) {
		g = 1 - g;
	}
	if (event.keyCode == 82) {
		magnet = 1;
		bacolor = "pink";
	}
	if (event.keyCode == 76) {
		magnet = -1;
		bacolor = "LightBlue";
	}
	if (event.keyCode == 79) {
		magnet = 0;
		bacolor = "beige";
	}
	if (event.keyCode == 89) {
		wallx = !wallx;
	}
	if (event.keyCode == 88) {
		wally = !wally;
	}
});

comenzar();

window.setInterval(jugar, 25);
	</script>
</body>